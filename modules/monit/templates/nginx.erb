#
# THIS FILE IS MANAGED BY PUPPET
#

check process nginx with pidfile /var/run/nginx.pid
   start program = "/etc/init.d/nginx start" with timeout 60 seconds
   stop program = "/etc/init.d/nginx stop"
   if cpu > 80% for 5 cycles then restart
   if failed port 443 type tcpssl protocol http
       with timeout 15 seconds
       then restart
   if 3 restarts within 5 cycles then timeout
   group server
